{{extend 'layout.html'}}


<div class="container ">
    <div class="row px-2 mb-3 bg-light">
        <div class="col p-1">
            <form class="form-inline my-2 pb-1 d-block" action="{{=URL('library','search')}}" method="get">
                <input style="height:40px; padding-right: 50px;" class="form-inline form-control mr-sm-2" name="s" type="text" autocomplete="off" placeholder="Search">
                <button style="border: none; margin-left: -65px; height: 35px; width:50px;" class="form-inline form-control btn  my-2 my-sm-0" type="submit">Go</button>
            </form>
            <div class="btn-group d-block" role="group" aria-label="Tag Select">
                <a class="btn btn-sm btn-info" href="{{=URL('library', 'index')}}">All</a>
                <a class="btn btn-sm {{='btn-secondary' if 'book' == tagname else 'btn-outline-dark'}}" href="{{=URL('library', 'index', vars=dict(b=1))}}">Books</a>
                {{for tag in tags:}}
                <a class="btn btn-sm {{='btn-secondary' if tag.name == tagname else 'btn-outline-dark'}}" href="{{=URL('library', 'index', vars=dict(t=tag.id))}}">{{=tag.name}}</a>
                {{pass}}
            </div>
        </div>
    </div>

    <div class="row  pl-5 p-2 fixed-bottom">
        <a class="btn btn-primary" href="{{=URL('library','update',extension='html')}}">Add Item</a>
    </div>

    {{for article in articles:}}
    {{controller = article['controller']}}

    {{readlink = URL(controller,'read',args=article['id'])}}
    {{if controller != 'library':}}
    {{readlink = URL(controller,'index',args=article['id'])}}
    {{pass}}

    <div class="row library-list">
        <div class="col-sm-1">
            <a class="library-link" href="{{=readlink}}">
                {{if controller != 'library':}}
                {{=controller_icon(controller, 32)}}
                {{else:}}
                {{=library_type_icon(article['articletype'],32)}}
                {{pass}}
            </a>
        </div>
        {{if article['img']:}}
        <div class="col-sm-7">
            {{else:}}
            <div class="col-sm-9">
                {{pass}}
                <a class="library-link" href="{{=readlink}}">
                    {{=makeTagList(article['tags'])}}
                    {{=DIV(B(article['name']))}}
                    {{=DIV(I(article['summary']))}}
                </a>
            </div>
            <div class="col-sm-1">
                {{if article['attachment']:}}
                <a href="{{=URL('default', 'download', args=article['attachment'])}}">
                    {{=filetype_icon(article['attachment'], 32) }}
                </a>
                {{pass}}
            </div>
            {{if article['img']:}}
            <div class="col-sm-2">
                <img class="img-thumbnail rounded" style="max-width: 150px; max-height:150px;" src="{{=URL('default', 'download', args=article['img'])}}" alt="Image" />
            </div>
            {{pass}}
            <div class="col-sm-1">
                {{=editButton(controller, 'update', article['id'])}}
            </div>

        </div>
        {{pass}}

        <!--<div class="row mt-5 mb-5">
            <a class="btn btn-primary" href="{{=URL('library','update',extension='html')}}">Add Item</a>
        </div>-->
    </div>